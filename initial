yum uprade
yum update
#
useradd XXXX
passwd XXX new_pass

#firewall

#ensyre chrony is started
#systemctl status -l chronyd

#apache
yum -y install httpd httpd-tools mod_ssl
systemctl enable httpd

#php 7.3
yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm -y
yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm -y
yum install yum-utils -y
yum-config-manager --enable remi-php73
yum install php php-mcrypt php-cli php-gd php-curl php-mysql php-ldap php-zip php-fileinfo php-opcache php-odbc php-pdo php-pear php-pecl-apc php-pecl-memcache php-pgsql php-soap php-xml php-xmlrpc php-imap php-mbstring php-common

#php-FM - ??
#PostgresSQL ?
#Ngix ?

#databse
yum install mariadb mariadb-server -y
systemctl start mariadb
systemctl enable mariadb
mysql_secure_installation

#postfixadmin

#postfix

#dovecot

#certbot
yum install certbot python2-certbot-apache
mkdir -p /var/www/mailnica.com/public_html
chmod -R 755 /var/www/mailnica.com/
chmod -R 755 /var/www/mailnica.com/public_html/
chown -R apache:apache /var/www/mailnica.com/public_html
chown -R apache:apache /var/www/mailnica.com/

mcedit /etc/httpd/mailnica.com.conf
<VirtualHost *:80>
    ServerName www.mailnica.com
    ServerAlias mailnica.com
    DocumentRoot /var/www/yourdomain.com/public_html
    ErrorLog /var/www/yourdomain.com/error.log
    CustomLog /var/www/yourdomain.com/requests.log combined
</VirtualHost>

systemctl restart httpd

certbot --apache -d mailnica.com
echo "0 0,12 * * * root python -c 'import random; import time; time.sleep(random.random() * 3600)' && certbot renew" | sudo tee -a /etc/crontab > /dev/null
#59 18 * * * cd /etc/letsencrypt/ && ./certbot-auto renew --force-renew && /etc/init.d/apache2 restart




